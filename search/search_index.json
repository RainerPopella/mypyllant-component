{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"myPyllant Library &amp; Home Assistant Component","text":"<p>Home Assistant component that interfaces with the myVAILLANT API  (and branded versions of it, such as the MiGo Link app from Saunier Duval &amp; Bulex). Uses the myPyllant library.</p>"},{"location":"#installation","title":"Installation","text":"<p>Note</p> <ol> <li>The developers are not affiliated with Vaillant, we take no responsibility for anything that happens to your devices because of this library</li> <li>This integration is not compatible with systems that use sensoAPP and multiMATIC</li> </ol>"},{"location":"#hacs","title":"HACS","text":"<ol> <li>Install HACS</li> <li>Search for the myVAILLANT integration in HACS and install it</li> <li>Restart Home Assistant</li> <li>Add myVaillant integration</li> <li>Sign in with the email &amp; password you used in the myVAILLANT app (or MiGo app for Saunier Duval)</li> </ol>"},{"location":"#manual","title":"Manual","text":"<ol> <li>Download the latest release</li> <li>Extract the <code>custom_components</code> folder to your Home Assistant's config folder, the resulting folder structure should be <code>config/custom_components/mypyllant</code></li> <li>Restart Home Assistant</li> <li>Add myVaillant integration, or go to Settings &gt; Integrations and add myVAILLANT</li> <li>Sign in with the email &amp; password you used in the myVAILLANT app (or MiGo app for Saunier Duval)</li> </ol>"},{"location":"#tested-setups","title":"Tested Setups","text":"<ul> <li>Vaillant aroTHERM plus heatpump + sensoCOMFORT VRC 720 + sensoNET VR 921</li> <li>Vaillant ECOTEC PLUS boiler + VR940F + sensoCOMFORT</li> <li>Vaillant ECOTEC PLUS boiler + VRT380f + sensoNET</li> <li>Saunier Duval DUOMAX F30 90 + MISET Radio + MiLink V3</li> <li>Bulex Thema Condens F30/35 + Red 5 + MiPro Sense + MiLink v3</li> </ul>"},{"location":"#features","title":"Features","text":"<ul> <li>Supports climate &amp; hot water controls, as well as sensor information</li> <li>Control operating modes, target temperature, and presets such as holiday more or quick veto</li> <li>Track sensor information of devices, such as temperature, humidity, operating mode, energy usage, or energy efficiency</li> <li>See diagnostic information, such as the current heating curve, flow temperature, or water pressure</li> <li>Custom services to set holiday mode or quick veto temperature overrides, and their duration</li> </ul>"},{"location":"#options","title":"Options","text":""},{"location":"#seconds-between-scans","title":"Seconds between scans","text":"<p>Wait interval between updating (most) sensors. The energy data and efficiency sensors have a fixed hourly interval.</p>"},{"location":"#delay-before-refreshing-data-after-updates","title":"Delay before refreshing data after updates","text":"<p>How long to wait between making a request (i.e. setting target temperature) and refreshing data. The Vaillant takes some time to return the updated values.</p>"},{"location":"#default-duration-in-hours-for-quick-veto","title":"Default duration in hours for quick veto","text":"<p>When setting the temperature with the climate controls, the integration uses the \"quick veto\" feature of the myVAILLANT app.</p> <p>With this option you can set for how long the temperature should stay set, before returning to the default value.</p>"},{"location":"#country","title":"Country","text":"<p>The country you registered your myVAILLANT account in. The list of options is limited to known supported countries.</p>"},{"location":"#brand","title":"Brand","text":"<p>Brand of your HVAC equipment and app, pick Saunier Duval if you use the MiGo Link app.</p>"},{"location":"#supported-brands-countries","title":"Supported Brands &amp; Countries","text":"<p>Missing a Country?</p> <p>If a country is missing, please open an issue or contribute a new country to the myPyllant library.</p> <ul> <li>Vaillant<ul> <li>Albania</li> <li>Austria</li> <li>Belgium</li> <li>Bulgaria</li> <li>Croatia</li> <li>Czechia</li> <li>Denmark</li> <li>Estonia</li> <li>Finland</li> <li>France</li> <li>Georgia</li> <li>Germany</li> <li>Greece</li> <li>Hungary</li> <li>Italy</li> <li>Latvia</li> <li>Lithuania</li> <li>Luxembourg</li> <li>Netherlands</li> <li>Norway</li> <li>Poland</li> <li>Portugal</li> <li>Romania</li> <li>Serbia</li> <li>Slovakia</li> <li>Slovenia</li> <li>Spain</li> <li>Sweden</li> <li>Switzerland</li> <li>Ukraine</li> <li>United Kingdom</li> <li>Uzbekistan</li> </ul> </li> <li>Saunier Duval<ul> <li>Austria</li> <li>Czechia</li> <li>Finland</li> <li>France</li> <li>Greece</li> <li>Hungary</li> <li>Italy</li> <li>Lithuania</li> <li>Poland</li> <li>Portugal</li> <li>Romania</li> <li>Slovakia</li> <li>Spain</li> </ul> </li> <li>Bulex<ul> <li>Does not support country selection, just leave the option empty</li> </ul> </li> </ul>"},{"location":"#known-issues","title":"Known Issues","text":""},{"location":"#lack-of-test-data-for-different-systems","title":"Lack of Test Data for Different Systems","text":"<p>Your HVAC system might differ from the ones in Tested Setups above. If you don't see any entities, or get an error during setup, please check Debugging and create an issue. With debugging enabled, there's a chance to find the culprit in the data returned by the myVAILLANT API and fix it.</p>"},{"location":"1-automations/","title":"Automations","text":""},{"location":"1-automations/#legionella-protection1","title":"Legionella Protection<sup>1</sup>","text":"<p>With the Home Assistant component, more flexible legionella protection is possible. You can tweak the time condition or the target temperature(s).</p> <pre><code>alias: Legionella Protection\ndescription: \"\"\ntrigger:\n- platform: time\nat: \"10:00:00\"\ncondition:\n- condition: time\nweekday:\n- sun  # (1)\naction:\n- service: water_heater.set_temperature\ndata:\ntemperature: 75 # (2)\ntarget:\nentity_id: water_heater.domestic_hot_water_0\n- delay:\nhours: 8 # (3)\nminutes: 0\nseconds: 0\nmilliseconds: 0\n- service: water_heater.set_temperature\ndata:\ntemperature: 50 # (4)\ntarget:\nentity_id: water_heater.domestic_hot_water_0\nmode: single\n</code></pre> <ol> <li>You can customize the frequency and weekday here, see Time condition documentation</li> <li>Here you can set the target temperature for legionella protection</li> <li>This is the duration. Make sure it covers the time period where your water heater is turned on</li> <li>This should be your regular water temperature</li> </ol> <ol> <li> <p>Contributed by CommanderROR in the Home Assistant Community \u21a9</p> </li> </ol>"},{"location":"2-entities/","title":"Entities","text":"<p>You can expect these entities, although names may vary based on your installed devices (in this example \"aroTHERM plus\"  and \"Hydraulic Station\") or the naming of your heating zones (in this case \"Zone 1\"):</p> Entity Unit Class Sample Cooling Allowed in Circuit 0 off Error sensoCOMFORT problem off Online Status sensoCOMFORT connectivity on Cooling Allowed in Circuit 0 off Zone 1 auto aroTHERM plus Consumed Electrical Energy Domestic Hot Water Wh energy 0 aroTHERM plus Consumed Electrical Energy Heating Wh energy 0 aroTHERM plus Earned Environment Energy Domestic Hot Water Wh energy 0 aroTHERM plus Earned Environment Energy Heating Wh energy 334.5 aroTHERM plus Heat Generated Heating Wh energy 334.5 aroTHERM plus Heat Generated Domestic Hot Water Wh energy 0 Hydraulic Station Consumed Electrical Energy Domestic Hot Water Wh energy 0 Heating Energy Efficiency 4 Cooling Allowed in Circuit 0 off Current Flow Temperature in Circuit 0 \u00b0C temperature 22.0 Heating Curve in Circuit 0 0.8 Min Flow Temperature Setpoint in Circuit 0 \u00b0C temperature 35.0 State in Circuit 0 STANDBY Desired Temperature in Zone 1 \u00b0C temperature 0.0 Current Temperature in Zone 1 \u00b0C temperature 18.5 Humidity in Zone 1 % humidity 60.0 Heating Operating Mode in Zone 1 Time Controlled Heating State in Zone 1 Idle Current Special Function in Zone 1 None Tank Temperature Domestic Hot Water 255 \u00b0C temperature 47.0 Setpoint Domestic Hot Water 255 \u00b0C temperature 49.0 Operation Mode Domestic Hot Water 255 Time Controlled Current Special Function Domestic Hot Water 255 Regular Domestic Hot Water 0 Time Controlled Outdoor Temperature \u00b0C temperature 2.29 System Mode REGULAR Water Pressure bar pressure 1.4"},{"location":"2-library/","title":"CLI &amp; Python Library","text":"<p>The myPyllant library can interact with the API behind the myVAILLANT app  (and branded versions of it, such as the MiGo app from Saunier Duval). Needs at least Python 3.10.</p> <p>Not affiliated with Vaillant, the developers take no responsibility for anything that happens to your devices because of this library.</p>"},{"location":"2-library/#installation","title":"Installation","text":"<p>Warning</p> <p>You need at least Python 3.10</p> <pre><code>pip install myPyllant\npython3 -m myPyllant.export user password brand --country country\n# See python3 -m myPyllant.export -h for more options and a list of countries\n</code></pre> <p>..or use Docker:</p> <pre><code>docker run -ti ghcr.io/signalkraft/mypyllant:latest python3 -m myPyllant.export user password brand --country country\n</code></pre> <p>The <code>--data</code> argument exports historical data of the devices in your system. Without this keyword, information about your system will be exported as JSON.</p>"},{"location":"2-library/#usage","title":"Usage","text":"<pre><code>#!/usr/bin/env python3\nimport argparse\nimport asyncio\nimport logging\nfrom datetime import datetime, timedelta\nfrom myPyllant.api import MyPyllantAPI\nfrom myPyllant.const import ALL_COUNTRIES, BRANDS, DEFAULT_BRAND\nparser = argparse.ArgumentParser(description=\"Export data from myVaillant API   .\")\nparser.add_argument(\"user\", help=\"Username (email address) for the myVaillant app\")\nparser.add_argument(\"password\", help=\"Password for the myVaillant app\")\nparser.add_argument(\n\"brand\",\nhelp=\"Brand your account is registered in, i.e. 'vaillant'\",\ndefault=DEFAULT_BRAND,\nchoices=BRANDS.keys(),\n)\nparser.add_argument(\n\"--country\",\nhelp=\"Country your account is registered in, i.e. 'germany'\",\nchoices=ALL_COUNTRIES.keys(),\nrequired=False,\n)\nparser.add_argument(\n\"-v\", \"--verbose\", help=\"increase output verbosity\", action=\"store_true\"\n)\nasync def main(user, password, brand, country):\nasync with MyPyllantAPI(user, password, brand, country) as api:\nasync for system in api.get_systems():\nprint(await api.get_time_zone(system))\nprint(\nawait api.set_holiday(\nsystem, datetime.now(), datetime.now() + timedelta(days=7)\n)\n)\nprint(await api.cancel_holiday(system))\nprint(await api.set_set_back_temperature(system.zones[0], 18))\nprint(await api.quick_veto_zone_temperature(system.zones[0], 21, 5))\nprint(await api.cancel_quick_veto_zone_temperature(system.zones[0]))\nif system.domestic_hot_water:\nprint(await api.boost_domestic_hot_water(system.domestic_hot_water[0]))\nprint(await api.cancel_hot_water_boost(system.domestic_hot_water[0]))\nprint(\nawait api.set_domestic_hot_water_temperature(\nsystem.domestic_hot_water[0], 46\n)\n)\nif __name__ == \"__main__\":\nargs = parser.parse_args()\nif args.verbose:\nlogging.basicConfig(level=logging.DEBUG)\nasyncio.run(main(args.user, args.password, args.brand, args.country))\n</code></pre>"},{"location":"2-library/#contributing-tests","title":"Contributing &amp; Tests","text":"<p>Warning</p> <p>You need at least Python 3.10</p> <p>I'm happy to accept PRs, if you run the pre-commit checks and test your changes:</p> <pre><code>git clone https://github.com/signalkraft/myPyllant.git\ncd myPyllant\npython3 -m venv .venv\nsource .venv/bin/activate\npip install -r requirements-dev.txt\npip install -e .\npre-commit install\npytest\n</code></pre>"},{"location":"2-services/","title":"Services","text":"<p>There are custom services to control holiday mode and quick veto temperatures for each climate zone. Search for \"myvaillant\" in Developer Tools &gt; Services in your Home Assistant instance to get the full list plus an interactive UI.</p> <p></p> <p></p>"},{"location":"3-contributing/","title":"Contributing","text":""},{"location":"3-contributing/#contributing-to-the-home-assistant-component","title":"Contributing to the Home Assistant Component","text":"<p>Warning</p> <p>You need at least Python 3.10.</p> <p>Fork and clone this repo, then from the root directory run:</p> <pre><code>python3 -m venv .venv\nsource .venv/bin/activate\npip install -r requirements.test.txt\npre-commit install\n# Make your changes\npytest\ngit commit ...\n</code></pre> <p>If you also need to modify the underlying myPyllant library, clone &amp; install it in editable mode in <code>mypyllant-component</code>:</p> <pre><code># From the root of this repository\ngit clone https://github.com/signalkraft/myPyllant.git ../myPyllant\npip install -e ../myPyllant\n</code></pre> <p>Now you can modify <code>myPyllant/src</code> and directly develop against these changes in <code>mypyllant-component</code>.</p>"},{"location":"3-contributing/#debugging","title":"Debugging","text":"<p>When debugging or reporting issues, turn on debug logging by adding this to your <code>configuration.yaml</code>  and restarting Home Assistant:</p> <pre><code>logger:\ndefault: warning\nlogs:\ncustom_components.mypyllant: debug\nmyPyllant: debug\n</code></pre>"},{"location":"3-contributing/#contributing-to-the-underlying-mypyllant-library","title":"Contributing to the underlying myPyllant library","text":"<p>Warning</p> <p>You need at least Python 3.10</p> <p>I'm happy to accept PRs, if you run the pre-commit checks and test your changes:</p> <pre><code>git clone https://github.com/signalkraft/myPyllant.git\ncd myPyllant\npython3 -m venv .venv\nsource .venv/bin/activate\npip install -r requirements-dev.txt\npip install -e .\npre-commit install\npytest\n</code></pre>"},{"location":"3-contributing/#supporting-new-countries","title":"Supporting new Countries","text":"<p>The myVAILLANT app uses Keycloak and OIDC for authentication, with a realm for each country and brand. There is a script to check which countries are supported:</p> <pre><code>python3 -m myPyllant.tests.find_countries\n</code></pre> <p>Copy the resulting dictionary into https://github.com/signalkraft/myPyllant/blob/main/src/myPyllant/const.py</p>"},{"location":"3-contributing/#contributing-test-data","title":"Contributing Test Data","text":"<p>Because the myVAILLANT API isn't documented, you can help the development of this library by contributing test data:</p> <pre><code>python3 -m myPyllant.tests.generate_test_data -h\npython3 -m myPyllant.tests.generate_test_data username password brand --country country\n</code></pre> <p>..or use Docker:</p> <pre><code>docker run -v $(pwd)/test_data:/build/src/myPyllant/tests/json -ti ghcr.io/signalkraft/mypyllant:latest python3 -m myPyllant.tests.generate_test_data username password brand --country country\n</code></pre> <p>With docker, the results will be put into <code>test_data/</code>.</p> <p>You can then either create a PR with the created folder, or zip it and attach it to an issue.</p>"},{"location":"3-contributing/#adding-new-api-endpoints","title":"Adding new API endpoints","text":"<p>If your myVAILLANT app has more features than this integration, chances are you have a more complex system then me. You can reverse engineer the API endpoints and open an issue with the requests + responses. See Reverse Engineering for a tutorial.</p>"},{"location":"3-reverse-engineering/","title":"Reverse Engineering Android Apps","text":"<p>Any Android app that makes HTTPS API requests (in this case to the myVAILLANT API), can be reverse engineered with an Android device and a laptop / PC that runs ADB. Both need to be on the same network. Creating a hotspot from the Android device also works.</p> <ol> <li>Run mitmproxy on your laptop, for example in Docker:     <pre><code>docker run --rm -it -v ~/.mitmproxy:/home/mitmproxy/.mitmproxy -p 0.0.0.0:8080:8080 -p 127.0.0.1:8081:8081 mitmproxy/mitmproxy mitmweb --web-host 0.0.0.0\n</code></pre></li> <li>In your Android WI-FI settings (see screenshot below) set a manual proxy to the IP of the device running mitmproxy on port 8080.    Add a bypass for <code>identity.vaillant-group.com</code><sup>1</sup></li> <li>Visit mitm.it on your Android device, download the CA cert &amp; install it through the settings app</li> <li>Install ADB on your laptop and connect your Android device to USB in debug mode</li> <li>Look for the myVAILLANT APK online and download it</li> <li>Run android-unpinner on the APK and wait for it to launch the modified app on your Android device with ADB</li> <li>You should see all API calls in mitmproxy's web interface on http://127.0.0.1:8081 now.     If you can't log in with SSO because of a certificate error, make sure you added the exception to the proxy settings.    If you can log in, but the app reports an error, the unpinning didn't work.    You can try MagiskTrustUserCertson if you have a rooted Android device.</li> </ol> <p> </p> Source: digitalcitizen.life <ol> <li> <p>The single-sign on gets handled in your browser, which uses certificate pinning as an added security measure\u00a0\u21a9</p> </li> </ol>"}]}